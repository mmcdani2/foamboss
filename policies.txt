[{"policyname": "Authenticated users can view materials","cmd": "SELECT","using_expression": "true","with_check": null},{"policyname": "Authenticated users can insert materials","cmd": "INSERT","using_expression": null,"with_check": "true"},{"policyname": "Authenticated users can update materials","cmd": "UPDATE","using_expression": "true","with_check": "true"},{"policyname": "Authenticated users can delete materials","cmd": "DELETE","using_expression": "true","with_check": null},{"policyname": "Manage own business types","cmd": "ALL","using_expression": "(business_id IN ( SELECT businesses.id\n   FROM businesses\n  WHERE (businesses.owner_id = auth.uid())))","with_check": null},{"policyname": "View types (own or system)","cmd": "SELECT","using_expression": "((is_system = true) OR (business_id IN ( SELECT businesses.id\n   FROM businesses\n  WHERE (businesses.owner_id = auth.uid()))))","with_check": null},{"policyname": "Manage material types","cmd": "ALL","using_expression": "(business_id IN ( SELECT users.business_id\n   FROM users\n  WHERE (users.id = auth.uid())))","with_check": "(business_id IN ( SELECT users.business_id\n   FROM users\n  WHERE (users.id = auth.uid())))"},{"policyname": "Manage material pricing","cmd": "ALL","using_expression": "(material_type_id IN ( SELECT material_types.id\n   FROM material_types\n  WHERE (material_types.business_id IN ( SELECT users.business_id\n           FROM users\n          WHERE (users.id = auth.uid())))))","with_check": "(material_type_id IN ( SELECT material_types.id\n   FROM material_types\n  WHERE (material_types.business_id IN ( SELECT users.business_id\n           FROM users\n          WHERE (users.id = auth.uid())))))"},{"policyname": "View categories (system or same business)","cmd": "SELECT","using_expression": "((is_system = true) OR (business_id IN ( SELECT users.business_id\n   FROM users\n  WHERE (users.id = auth.uid()))) OR (NOT (business_id IS DISTINCT FROM ( SELECT users.business_id\n   FROM users\n  WHERE (users.id = auth.uid())))))","with_check": null},{"policyname": "Manage business categories","cmd": "ALL","using_expression": "(business_id IN ( SELECT users.business_id\n   FROM users\n  WHERE (users.id = auth.uid())))","with_check": "((business_id IN ( SELECT users.business_id\n   FROM users\n  WHERE (users.id = auth.uid()))) OR (auth.uid() = ( SELECT users.id\n   FROM users\n  WHERE (users.id = auth.uid()))))"}]